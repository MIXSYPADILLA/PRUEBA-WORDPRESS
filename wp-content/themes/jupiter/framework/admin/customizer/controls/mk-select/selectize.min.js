/*! selectize.js - v0.12.4 | https://github.com/selectize/selectize.js | Apache License (v2) */
(function(t,s){'function'==typeof define&&define.amd?define('sifter',s):'object'==typeof exports?module.exports=s():t.Sifter=s()})(this,function(){var t=function(h,m){this.items=h,this.settings=m||{diacritics:!0}};t.prototype.tokenize=function(h){if(h=l(((h||'')+'').toLowerCase()),!h||!h.length)return[];var m,f,v,O,C=[],w=h.split(/ +/);for(m=0,f=w.length;m<f;m++){if(v=p(w[m]),this.settings.diacritics)for(O in c)c.hasOwnProperty(O)&&(v=v.replace(new RegExp(O,'g'),c[O]));C.push({string:w[m],regex:new RegExp(v,'i')})}return C},t.prototype.iterator=function(h,m){var f;f=u(h)?Array.prototype.forEach||function(v){for(var O=0,C=this.length;O<C;O++)v(this[O],O,this)}:function(v){for(var O in this)this.hasOwnProperty(O)&&v(this[O],O,this)},f.apply(h,[m])},t.prototype.getScoreFunction=function(h,m){var f,v,O,C,w;f=this,h=f.prepareSearch(h,m),O=h.tokens,v=h.options.fields,C=O.length,w=h.options.nesting;var _=function(S,I){var F,D;return S?(S=(S||'')+'',D=S.search(I.regex),-1===D)?0:(F=I.string.length/S.length,0===D&&(F+=0.5),F):0},x=function(){var S=v.length;return S?1===S?function(I,F){return _(r(F,v[0],w),I)}:function(I,F){for(var D=0,P=0;D<S;D++)P+=_(r(F,v[D],w),I);return P/S}:function(){return 0}}();return C?1===C?function(S){return x(O[0],S)}:'and'===h.options.conjunction?function(S){for(var I,F=0,D=0;F<C;F++){if(I=x(O[F],S),0>=I)return 0;D+=I}return D/C}:function(S){for(var I=0,F=0;I<C;I++)F+=x(O[I],S);return F/C}:function(){return 0}},t.prototype.getSortFunction=function(h,m){var f,v,O,C,w,_,x,S,I,F,D;if(O=this,h=O.prepareSearch(h,m),D=!h.query&&m.sort_empty||m.sort,I=function(P,A){return'$score'===P?A.score:r(O.items[A.id],P,m.nesting)},w=[],D)for(f=0,v=D.length;f<v;f++)(h.query||'$score'!==D[f].field)&&w.push(D[f]);if(h.query){for(F=!0,f=0,v=w.length;f<v;f++)if('$score'===w[f].field){F=!1;break}F&&w.unshift({field:'$score',direction:'desc'})}else for(f=0,v=w.length;f<v;f++)if('$score'===w[f].field){w.splice(f,1);break}for(S=[],f=0,v=w.length;f<v;f++)S.push('desc'===w[f].direction?-1:1);return _=w.length,_?1===_?(C=w[0].field,x=S[0],function(P,A){return x*s(I(C,P),I(C,A))}):function(P,A){var z,T,V;for(z=0;z<_;z++)if(V=w[z].field,T=S[z]*s(I(V,P),I(V,A)),T)return T;return 0}:null},t.prototype.prepareSearch=function(h,m){if('object'==typeof h)return h;m=o({},m);var f=m.fields,v=m.sort,O=m.sort_empty;return f&&!u(f)&&(m.fields=[f]),v&&!u(v)&&(m.sort=[v]),O&&!u(O)&&(m.sort_empty=[O]),{options:m,query:((h||'')+'').toLowerCase(),tokens:this.tokenize(h),total:0,items:[]}},t.prototype.search=function(h,m){var O,C,_,x,f=this;return C=this.prepareSearch(h,m),m=C.options,h=C.query,x=m.score||f.getScoreFunction(C),h.length?f.iterator(f.items,function(S,I){O=x(S),(!1===m.filter||0<O)&&C.items.push({score:O,id:I})}):f.iterator(f.items,function(S,I){C.items.push({score:1,id:I})}),_=f.getSortFunction(C,m),_&&C.items.sort(_),C.total=C.items.length,'number'==typeof m.limit&&(C.items=C.items.slice(0,m.limit)),C};var s=function(h,m){return'number'==typeof h&&'number'==typeof m?h>m?1:h<m?-1:0:(h=g((h||'')+''),m=g((m||'')+''),h>m?1:m>h?-1:0)},o=function(h){var f,v,O,C;for(f=1,v=arguments.length;f<v;f++)if(C=arguments[f],C)for(O in C)C.hasOwnProperty(O)&&(h[O]=C[O]);return h},r=function(h,m,f){if(h&&m){if(!f)return h[m];for(var v=m.split('.');v.length&&(h=h[v.shift()]););return h}},l=function(h){return(h+'').replace(/^\s+|\s+$|/g,'')},p=function(h){return(h+'').replace(/([.?*+^$[\]\\(){}|-])/g,'\\$1')},u=Array.isArray||'undefined'!=typeof $&&$.isArray||function(h){return'[object Array]'===Object.prototype.toString.call(h)},c={a:'[a\u1E00\u1E01\u0102\u0103\xC2\xE2\u01CD\u01CE\u023A\u2C65\u0226\u0227\u1EA0\u1EA1\xC4\xE4\xC0\xE0\xC1\xE1\u0100\u0101\xC3\xE3\xC5\xE5\u0105\u0104\xC3\u0105\u0104]',b:'[b\u2422\u03B2\u0392B\u0E3F\uD800\uDF01\u16D2]',c:'[c\u0106\u0107\u0108\u0109\u010C\u010D\u010A\u010BC\u0304c\u0304\xC7\xE7\u1E08\u1E09\u023B\u023C\u0187\u0188\u0255\u1D04\uFF23\uFF43]',d:'[d\u010E\u010F\u1E0A\u1E0B\u1E10\u1E11\u1E0C\u1E0D\u1E12\u1E13\u1E0E\u1E0F\u0110\u0111D\u0326d\u0326\u0189\u0256\u018A\u0257\u018B\u018C\u1D6D\u1D81\u1D91\u0221\u1D05\uFF24\uFF44\xF0]',e:'[e\xC9\xE9\xC8\xE8\xCA\xEA\u1E18\u1E19\u011A\u011B\u0114\u0115\u1EBC\u1EBD\u1E1A\u1E1B\u1EBA\u1EBB\u0116\u0117\xCB\xEB\u0112\u0113\u0228\u0229\u0118\u0119\u1D92\u0246\u0247\u0204\u0205\u1EBE\u1EBF\u1EC0\u1EC1\u1EC4\u1EC5\u1EC2\u1EC3\u1E1C\u1E1D\u1E16\u1E17\u1E14\u1E15\u0206\u0207\u1EB8\u1EB9\u1EC6\u1EC7\u2C78\u1D07\uFF25\uFF45\u0258\u01DD\u018F\u0190\u03B5]',f:'[f\u0191\u0192\u1E1E\u1E1F]',g:'[g\u0262\u20B2\u01E4\u01E5\u011C\u011D\u011E\u011F\u0122\u0123\u0193\u0260\u0120\u0121]',h:'[h\u0124\u0125\u0126\u0127\u1E28\u1E29\u1E96\u1E96\u1E24\u1E25\u1E22\u1E23\u0266\u02B0\u01F6\u0195]',i:'[i\xCD\xED\xCC\xEC\u012C\u012D\xCE\xEE\u01CF\u01D0\xCF\xEF\u1E2E\u1E2F\u0128\u0129\u012E\u012F\u012A\u012B\u1EC8\u1EC9\u0208\u0209\u020A\u020B\u1ECA\u1ECB\u1E2C\u1E2D\u0197\u0268\u0268\u0306\u1D7B\u1D96\u0130iI\u0131\u026A\uFF29\uFF49]',j:'[j\u0237\u0134\u0135\u0248\u0249\u029D\u025F\u02B2]',k:'[k\u0198\u0199\uA740\uA741\u1E30\u1E31\u01E8\u01E9\u1E32\u1E33\u1E34\u1E35\u03BA\u03F0\u20AD]',l:'[l\u0141\u0142\u013D\u013E\u013B\u013C\u0139\u013A\u1E36\u1E37\u1E38\u1E39\u1E3C\u1E3D\u1E3A\u1E3B\u013F\u0140\u023D\u019A\u2C60\u2C61\u2C62\u026B\u026C\u1D85\u026D\u0234\u029F\uFF2C\uFF4C]',n:'[n\u0143\u0144\u01F8\u01F9\u0147\u0148\xD1\xF1\u1E44\u1E45\u0145\u0146\u1E46\u1E47\u1E4A\u1E4B\u1E48\u1E49N\u0308n\u0308\u019D\u0272\u0220\u019E\u1D70\u1D87\u0273\u0235\u0274\uFF2E\uFF4E\u014A\u014B]',o:'[o\xD8\xF8\xD6\xF6\xD3\xF3\xD2\xF2\xD4\xF4\u01D1\u01D2\u0150\u0151\u014E\u014F\u022E\u022F\u1ECC\u1ECD\u019F\u0275\u01A0\u01A1\u1ECE\u1ECF\u014C\u014D\xD5\xF5\u01EA\u01EB\u020C\u020D\u0555\u0585]',p:'[p\u1E54\u1E55\u1E56\u1E57\u2C63\u1D7D\u01A4\u01A5\u1D71]',q:'[q\uA756\uA757\u02A0\u024A\u024B\uA758\uA759q\u0303]',r:'[r\u0154\u0155\u024C\u024D\u0158\u0159\u0156\u0157\u1E58\u1E59\u0210\u0211\u0212\u0213\u1E5A\u1E5B\u2C64\u027D]',s:'[s\u015A\u015B\u1E60\u1E61\u1E62\u1E63\uA7A8\uA7A9\u015C\u015D\u0160\u0161\u015E\u015F\u0218\u0219S\u0308s\u0308]',t:'[t\u0164\u0165\u1E6A\u1E6B\u0162\u0163\u1E6C\u1E6D\u01AE\u0288\u021A\u021B\u1E70\u1E71\u1E6E\u1E6F\u01AC\u01AD]',u:'[u\u016C\u016D\u0244\u0289\u1EE4\u1EE5\xDC\xFC\xDA\xFA\xD9\xF9\xDB\xFB\u01D3\u01D4\u0170\u0171\u016C\u016D\u01AF\u01B0\u1EE6\u1EE7\u016A\u016B\u0168\u0169\u0172\u0173\u0214\u0215\u222A]',v:'[v\u1E7C\u1E7D\u1E7E\u1E7F\u01B2\u028B\uA75E\uA75F\u2C71\u028B]',w:'[w\u1E82\u1E83\u1E80\u1E81\u0174\u0175\u1E84\u1E85\u1E86\u1E87\u1E88\u1E89]',x:'[x\u1E8C\u1E8D\u1E8A\u1E8B\u03C7]',y:'[y\xDD\xFD\u1EF2\u1EF3\u0176\u0177\u0178\xFF\u1EF8\u1EF9\u1E8E\u1E8F\u1EF4\u1EF5\u024E\u024F\u01B3\u01B4]',z:'[z\u0179\u017A\u1E90\u1E91\u017D\u017E\u017B\u017C\u1E92\u1E93\u1E94\u1E95\u01B5\u01B6]'},g=function(){var h,m,f,v,O='',C={};for(f in c)if(c.hasOwnProperty(f))for(v=c[f].substring(2,c[f].length-1),O+=v,(h=0,m=v.length);h<m;h++)C[v.charAt(h)]=f;var w=new RegExp('['+O+']','g');return function(_){return _.replace(w,function(x){return C[x]}).toLowerCase()}}();return t}),function(t,s){'function'==typeof define&&define.amd?define('microplugin',s):'object'==typeof exports?module.exports=s():t.MicroPlugin=s()}(this,function(){var s={isArray:Array.isArray||function(o){return'[object Array]'===Object.prototype.toString.call(o)}};return{mixin:function(o){o.plugins={},o.prototype.initializePlugins=function(r){var l,p,u,c=this,g=[];if(c.plugins={names:[],settings:{},requested:{},loaded:{}},s.isArray(r))for(l=0,p=r.length;l<p;l++)'string'==typeof r[l]?g.push(r[l]):(c.plugins.settings[r[l].name]=r[l].options,g.push(r[l].name));else if(r)for(u in r)r.hasOwnProperty(u)&&(c.plugins.settings[u]=r[u],g.push(u));for(;g.length;)c.require(g.shift())},o.prototype.loadPlugin=function(r){var l=this,p=l.plugins,u=o.plugins[r];if(!o.plugins.hasOwnProperty(r))throw new Error('Unable to find "'+r+'" plugin');p.requested[r]=!0,p.loaded[r]=u.fn.apply(l,[l.plugins.settings[r]||{}]),p.names.push(r)},o.prototype.require=function(r){var l=this,p=l.plugins;if(!l.plugins.loaded.hasOwnProperty(r)){if(p.requested[r])throw new Error('Plugin has circular dependency ("'+r+'")');l.loadPlugin(r)}return p.loaded[r]},o.define=function(r,l){o.plugins[r]={name:r,fn:l}}}}}),function(t,s){'function'==typeof define&&define.amd?define('selectize',['jquery','sifter','microplugin'],s):'object'==typeof exports?module.exports=s(require('jquery'),require('sifter'),require('microplugin')):t.Selectize=s(t.jQuery,t.Sifter,t.MicroPlugin)}(this,function(t,s,o){'use strict';var r=function(X,Y){if('string'!=typeof Y||Y.length){var Z='string'==typeof Y?new RegExp(Y,'i'):Y,ee=function(te){var ne=0;if(3===te.nodeType){var ie=te.data.search(Z);if(0<=ie&&0<te.data.length){var se=te.data.match(Z),oe=document.createElement('span');oe.className='highlight';var re=te.splitText(ie),ae=re.splitText(se[0].length),le=re.cloneNode(!0);oe.appendChild(le),re.parentNode.replaceChild(oe,re),ne=1}}else if(1===te.nodeType&&te.childNodes&&!/(script|style)/i.test(te.tagName))for(var de=0;de<te.childNodes.length;++de)de+=ee(te.childNodes[de]);return ne};return X.each(function(){ee(this)})}};t.fn.removeHighlight=function(){return this.find('span.highlight').each(function(){this.parentNode.firstChild.nodeName;var X=this.parentNode;X.replaceChild(this.firstChild,this),X.normalize()}).end()};var l=function(){};l.prototype={on:function(X,Y){this._events=this._events||{},this._events[X]=this._events[X]||[],this._events[X].push(Y)},off:function(X,Y){var Z=arguments.length;return 0===Z?delete this._events:1===Z?delete this._events[X]:void(this._events=this._events||{},!1==X in this._events||this._events[X].splice(this._events[X].indexOf(Y),1))},trigger:function(X){if(this._events=this._events||{},!1!=X in this._events)for(var Y=0;Y<this._events[X].length;Y++)this._events[X][Y].apply(this,Array.prototype.slice.call(arguments,1))}},l.mixin=function(X){for(var Y=['on','off','trigger'],Z=0;Z<Y.length;Z++)X.prototype[Y[Z]]=l.prototype[Y[Z]]};var p=/Mac/.test(navigator.userAgent),m=37,O=39,_=8,x=46,I=p?91:17,F=p?18:17,D=9,P=1,z=!/android/i.test(window.navigator.userAgent)&&!!document.createElement('input').validity,T=function(X){return'undefined'!=typeof X},N=function(X){return'undefined'==typeof X||null===X?null:'boolean'==typeof X?X?'1':'0':X+''},q=function(X){return(X+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;')},H={};H.before=function(X,Y,Z){var ee=X[Y];X[Y]=function(){return Z.apply(X,arguments),ee.apply(X,arguments)}},H.after=function(X,Y,Z){var ee=X[Y];X[Y]=function(){var te=ee.apply(X,arguments);return Z.apply(X,arguments),te}};var L=function(X){var Y=!1;return function(){Y||(Y=!0,X.apply(this,arguments))}},K=function(X,Y){var Z;return function(){var ee=this,te=arguments;window.clearTimeout(Z),Z=window.setTimeout(function(){X.apply(ee,te)},Y)}},E=function(X,Y,Z){var ee,te=X.trigger,ne={};for(ee in X.trigger=function(){var ie=arguments[0];return-1===Y.indexOf(ie)?te.apply(X,arguments):void(ne[ie]=arguments)},Z.apply(X,[]),X.trigger=te,ne)ne.hasOwnProperty(ee)&&te.apply(X,ne[ee])},R=function(X,Y,Z,ee){X.on(Y,Z,function(te){for(var ne=te.target;ne&&ne.parentNode!==X[0];)ne=ne.parentNode;return te.currentTarget=ne,ee.apply(this,[te])})},W=function(X){var Y={};if('selectionStart'in X)Y.start=X.selectionStart,Y.length=X.selectionEnd-Y.start;else if(document.selection){X.focus();var Z=document.selection.createRange(),ee=document.selection.createRange().text.length;Z.moveStart('character',-X.value.length),Y.start=Z.text.length-ee,Y.length=ee}return Y},Q=function(X,Y,Z){var ee,te,ne={};if(Z)for(ee=0,te=Z.length;ee<te;ee++)ne[Z[ee]]=X.css(Z[ee]);else ne=X.css();Y.css(ne)},B=function(X,Y){if(!X)return 0;var Z=t('<test>').css({position:'absolute',top:-99999,left:-99999,width:'auto',padding:0,whiteSpace:'pre'}).text(X).appendTo('body');Q(Y,Z,['letterSpacing','fontSize','fontFamily','fontWeight','textTransform']);var ee=Z.width();return Z.remove(),ee},G=function(X){var Y=null,Z=function(ee,te){var ne,ie,se,oe,re,ae,le,de;ee=ee||window.event||{},te=te||{},ee.metaKey||ee.altKey||!te.force&&!1===X.data('grow')||(ne=X.val(),ee.type&&'keydown'===ee.type.toLowerCase()&&(ie=ee.keyCode,se=97<=ie&&122>=ie||65<=ie&&90>=ie||48<=ie&&57>=ie||32===ie,ie===x||ie===_?(de=W(X[0]),de.length?ne=ne.substring(0,de.start)+ne.substring(de.start+de.length):ie===_&&de.start?ne=ne.substring(0,de.start-1)+ne.substring(de.start+1):ie==x&&'undefined'!=typeof de.start&&(ne=ne.substring(0,de.start)+ne.substring(de.start+1))):se&&(ae=ee.shiftKey,le=String.fromCharCode(ee.keyCode),le=ae?le.toUpperCase():le.toLowerCase(),ne+=le)),oe=X.attr('placeholder'),!ne&&oe&&(ne=oe),re=B(ne,X)+4,re!==Y&&(Y=re,X.width(re),X.triggerHandler('resize')))};X.on('keydown keyup update blur',Z),Z()},M=function(X){var Y=document.createElement('div');return Y.appendChild(X.cloneNode(!0)),Y.innerHTML},J=function(X,Y){var ee,te,ne,ie,se=this;ie=X[0],ie.selectize=se;var oe=window.getComputedStyle&&window.getComputedStyle(ie,null);if(ne=oe?oe.getPropertyValue('direction'):ie.currentStyle&&ie.currentStyle.direction,ne=ne||X.parents('[dir]:first').attr('dir')||'',t.extend(se,{order:0,settings:Y,$input:X,tabIndex:X.attr('tabindex')||'',tagType:'select'===ie.tagName.toLowerCase()?P:2,rtl:/rtl/i.test(ne),eventNS:'.selectize'+ ++J.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:X.is('[required]'),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:'',caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===Y.loadThrottle?se.onSearchChange:K(se.onSearchChange,Y.loadThrottle)}),se.sifter=new s(this.options,{diacritics:Y.diacritics}),se.settings.options){for(ee=0,te=se.settings.options.length;ee<te;ee++)se.registerOption(se.settings.options[ee]);delete se.settings.options}if(se.settings.optgroups){for(ee=0,te=se.settings.optgroups.length;ee<te;ee++)se.registerOptionGroup(se.settings.optgroups[ee]);delete se.settings.optgroups}se.settings.mode=se.settings.mode||(1===se.settings.maxItems?'single':'multi'),'boolean'!=typeof se.settings.hideSelected&&(se.settings.hideSelected='multi'===se.settings.mode),se.initializePlugins(se.settings.plugins),se.setupCallbacks(),se.setupTemplates(),se.setup()};return l.mixin(J),'undefined'==typeof o?function(X,Y){Y||(Y={});console.error('Selectize'+': '+X),Y.explanation&&(console.group&&console.group(),console.error(Y.explanation),console.group&&console.groupEnd())}('Dependency MicroPlugin is missing',{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}):o.mixin(J),t.extend(J.prototype,{setup:function(){var ie,se,oe,re,ae,le,de,ce,ge,he,X=this,Y=X.settings,Z=X.eventNS,ee=t(window),te=t(document),ne=X.$input;if(de=X.settings.mode,ce=ne.attr('class')||'',ie=t('<div>').addClass(Y.wrapperClass).addClass(ce).addClass(de),se=t('<div>').addClass(Y.inputClass).addClass('items').appendTo(ie),oe=t('<input type="text" autocomplete="off" />').appendTo(se).attr('tabindex',ne.is(':disabled')?'-1':X.tabIndex),le=t(Y.dropdownParent||ie),re=t('<div>').addClass(Y.dropdownClass).addClass(de).hide().appendTo(le),ae=t('<div>').addClass(Y.dropdownContentClass).appendTo(re),(he=ne.attr('id'))&&(oe.attr('id',he+'-selectized'),t('label[for=\''+he+'\']').attr('for',he+'-selectized')),X.settings.copyClassesToDropdown&&re.addClass(ce),ie.css({width:ne[0].style.width}),X.plugins.names.length&&(ge='plugin-'+X.plugins.names.join(' plugin-'),ie.addClass(ge),re.addClass(ge)),(null===Y.maxItems||1<Y.maxItems)&&X.tagType===P&&ne.attr('multiple','multiple'),X.settings.placeholder&&oe.attr('placeholder',Y.placeholder),!X.settings.splitOn&&X.settings.delimiter){var me=X.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');X.settings.splitOn=new RegExp('\\s*'+me+'+\\s*')}ne.attr('autocorrect')&&oe.attr('autocorrect',ne.attr('autocorrect')),ne.attr('autocapitalize')&&oe.attr('autocapitalize',ne.attr('autocapitalize')),X.$wrapper=ie,X.$control=se,X.$control_input=oe,X.$dropdown=re,X.$dropdown_content=ae,re.on('mouseenter','[data-selectable]',function(){return X.onOptionHover.apply(X,arguments)}),re.on('mousedown click','[data-selectable]',function(){return X.onOptionSelect.apply(X,arguments)}),R(se,'mousedown','*:not(input)',function(){return X.onItemSelect.apply(X,arguments)}),G(oe),se.on({mousedown:function(){return X.onMouseDown.apply(X,arguments)},click:function(){return X.onClick.apply(X,arguments)}}),oe.on({mousedown:function(fe){fe.stopPropagation()},keydown:function(){return X.onKeyDown.apply(X,arguments)},keyup:function(){return X.onKeyUp.apply(X,arguments)},keypress:function(){return X.onKeyPress.apply(X,arguments)},resize:function(){X.positionDropdown.apply(X,[])},blur:function(){return X.onBlur.apply(X,arguments)},focus:function(){return X.ignoreBlur=!1,X.onFocus.apply(X,arguments)},paste:function(){return X.onPaste.apply(X,arguments)}}),te.on('keydown'+Z,function(fe){X.isCmdDown=fe[p?'metaKey':'ctrlKey'],X.isCtrlDown=fe[p?'altKey':'ctrlKey'],X.isShiftDown=fe.shiftKey}),te.on('keyup'+Z,function(fe){fe.keyCode===F&&(X.isCtrlDown=!1),fe.keyCode===16&&(X.isShiftDown=!1),fe.keyCode===I&&(X.isCmdDown=!1)}),te.on('mousedown'+Z,function(fe){if(X.isFocused){if(fe.target===X.$dropdown[0]||fe.target.parentNode===X.$dropdown[0])return!1;X.$control.has(fe.target).length||fe.target===X.$control[0]||X.blur(fe.target)}}),ee.on(['scroll'+Z,'resize'+Z].join(' '),function(){X.isOpen&&X.positionDropdown.apply(X,arguments)}),ee.on('mousemove'+Z,function(){X.ignoreHover=!1}),this.revertSettings={$children:ne.children().detach(),tabindex:ne.attr('tabindex')},ne.attr('tabindex',-1).hide().after(X.$wrapper),t.isArray(Y.items)&&(X.setValue(Y.items),delete Y.items),z&&ne.on('invalid'+Z,function(fe){fe.preventDefault(),X.isInvalid=!0,X.refreshState()}),X.updateOriginalInput(),X.refreshItems(),X.refreshState(),X.updatePlaceholder(),X.isSetup=!0,ne.is(':disabled')&&X.disable(),X.on('change',this.onChange),ne.data('selectize',X),ne.addClass('selectized'),X.trigger('initialize'),!0===Y.preload&&X.onSearchChange('')},setupTemplates:function(){var X=this,Y=X.settings.labelField,Z=X.settings.optgroupLabelField;X.settings.render=t.extend({},{optgroup:function(te){return'<div class="optgroup">'+te.html+'</div>'},optgroup_header:function(te,ne){return'<div class="optgroup-header">'+ne(te[Z])+'</div>'},option:function(te,ne){return'<div class="option">'+ne(te[Y])+'</div>'},item:function(te,ne){return'<div class="item">'+ne(te[Y])+'</div>'},option_create:function(te,ne){return'<div class="create">Add <strong>'+ne(te.input)+'</strong>&hellip;</div>'}},X.settings.render)},setupCallbacks:function(){var X,Y,Z={initialize:'onInitialize',change:'onChange',item_add:'onItemAdd',item_remove:'onItemRemove',clear:'onClear',option_add:'onOptionAdd',option_remove:'onOptionRemove',option_clear:'onOptionClear',optgroup_add:'onOptionGroupAdd',optgroup_remove:'onOptionGroupRemove',optgroup_clear:'onOptionGroupClear',dropdown_open:'onDropdownOpen',dropdown_close:'onDropdownClose',type:'onType',load:'onLoad',focus:'onFocus',blur:'onBlur'};for(X in Z)Z.hasOwnProperty(X)&&(Y=this.settings[Z[X]],Y&&this.on(X,Y))},onClick:function(X){var Y=this;Y.isFocused||(Y.close(),X.preventDefault())},onMouseDown:function(X){var Y=this,Z=X.isDefaultPrevented(),ee=t(X.target);if(!Y.isFocused)Z||window.setTimeout(function(){Y.focus()},0);else if(X.target!==Y.$control_input[0])return'single'===Y.settings.mode?Y.isOpen?Y.close():Y.open():!Z&&Y.setActiveItem(null),!1},onChange:function(){this.$input.trigger('change')},onPaste:function(X){var Y=this;return Y.isFull()||Y.isInputHidden||Y.isLocked?void X.preventDefault():void(Y.settings.splitOn&&setTimeout(function(){var Z=Y.$control_input.val();if(Z.match(Y.settings.splitOn))for(var ee=t.trim(Z).split(Y.settings.splitOn),te=0,ne=ee.length;te<ne;te++)Y.createItem(ee[te])},0))},onKeyPress:function(X){if(this.isLocked)return X&&X.preventDefault();var Y=String.fromCharCode(X.keyCode||X.which);if(this.settings.create&&'multi'===this.settings.mode&&Y===this.settings.delimiter)return this.createItem(),X.preventDefault(),!1},onKeyDown:function(X){var Y=X.target===this.$control_input[0],Z=this;if(Z.isLocked)return void(X.keyCode!==D&&X.preventDefault());switch(X.keyCode){case 65:if(Z.isCmdDown)return void Z.selectAll();break;case 27:return void(Z.isOpen&&(X.preventDefault(),X.stopPropagation(),Z.close()));case 78:if(!X.ctrlKey||X.altKey)break;case 40:if(!Z.isOpen&&Z.hasOptions)Z.open();else if(Z.$activeOption){Z.ignoreHover=!0;var ee=Z.getAdjacentOption(Z.$activeOption,1);ee.length&&Z.setActiveOption(ee,!0,!0)}return void X.preventDefault();case 80:if(!X.ctrlKey||X.altKey)break;case 38:if(Z.$activeOption){Z.ignoreHover=!0;var te=Z.getAdjacentOption(Z.$activeOption,-1);te.length&&Z.setActiveOption(te,!0,!0)}return void X.preventDefault();case 13:return void(Z.isOpen&&Z.$activeOption&&(Z.onOptionSelect({currentTarget:Z.$activeOption}),X.preventDefault()));case m:return void Z.advanceSelection(-1,X);case O:return void Z.advanceSelection(1,X);case D:return Z.settings.selectOnTab&&Z.isOpen&&Z.$activeOption&&(Z.onOptionSelect({currentTarget:Z.$activeOption}),!Z.isFull()&&X.preventDefault()),void(Z.settings.create&&Z.createItem()&&X.preventDefault());case _:case x:return void Z.deleteSelection(X);}if((Z.isFull()||Z.isInputHidden)&&(p?!X.metaKey:!X.ctrlKey))return void X.preventDefault()},onKeyUp:function(X){var Y=this;if(Y.isLocked)return X&&X.preventDefault();var Z=Y.$control_input.val()||'';Y.lastValue!==Z&&(Y.lastValue=Z,Y.onSearchChange(Z),Y.refreshOptions(),Y.trigger('type',Z))},onSearchChange:function(X){var Y=this,Z=Y.settings.load;!Z||Y.loadedSearches.hasOwnProperty(X)||(Y.loadedSearches[X]=!0,Y.load(function(ee){Z.apply(Y,[X,ee])}))},onFocus:function(X){var Y=this,Z=Y.isFocused;return Y.isDisabled?(Y.blur(),X&&X.preventDefault(),!1):void(Y.ignoreFocus||(Y.isFocused=!0,'focus'===Y.settings.preload&&Y.onSearchChange(''),!Z&&Y.trigger('focus'),!Y.$activeItems.length&&(Y.showInput(),Y.setActiveItem(null),Y.refreshOptions(!!Y.settings.openOnFocus)),Y.refreshState()))},onBlur:function(X,Y){var Z=this;if(Z.isFocused&&(Z.isFocused=!1,!Z.ignoreFocus)){if(!Z.ignoreBlur&&document.activeElement===Z.$dropdown_content[0])return Z.ignoreBlur=!0,void Z.onFocus(X);var ee=function(){Z.close(),Z.setTextboxValue(''),Z.setActiveItem(null),Z.setActiveOption(null),Z.setCaret(Z.items.length),Z.refreshState(),Y&&Y.focus&&Y.focus(),Z.ignoreFocus=!1,Z.trigger('blur')};Z.ignoreFocus=!0,Z.settings.create&&Z.settings.createOnBlur?Z.createItem(null,!1,ee):ee()}},onOptionHover:function(X){this.ignoreHover||this.setActiveOption(X.currentTarget,!1)},onOptionSelect:function(X){var Y,Z,te=this;X.preventDefault&&(X.preventDefault(),X.stopPropagation()),Z=t(X.currentTarget),Z.hasClass('create')?te.createItem(null,function(){te.settings.closeAfterSelect&&te.close()}):(Y=Z.attr('data-value'),'undefined'!=typeof Y&&(te.lastQuery=null,te.setTextboxValue(''),te.addItem(Y),te.settings.closeAfterSelect?te.close():!te.settings.hideSelected&&X.type&&/mouse/.test(X.type)&&te.setActiveOption(te.getOption(Y))))},onItemSelect:function(X){var Y=this;Y.isLocked||'multi'===Y.settings.mode&&(X.preventDefault(),Y.setActiveItem(X.currentTarget,X))},load:function(X){var Y=this,Z=Y.$wrapper.addClass(Y.settings.loadingClass);Y.loading++,X.apply(Y,[function(ee){Y.loading=Math.max(Y.loading-1,0),ee&&ee.length&&(Y.addOption(ee),Y.refreshOptions(Y.isFocused&&!Y.isInputHidden)),Y.loading||Z.removeClass(Y.settings.loadingClass),Y.trigger('load',ee)}])},setTextboxValue:function(X){var Y=this.$control_input,Z=Y.val()!==X;Z&&(Y.val(X).triggerHandler('update'),this.lastValue=X)},getValue:function(){return this.tagType===P&&this.$input.attr('multiple')?this.items:this.items.join(this.settings.delimiter)},setValue:function(X,Y){var Z=Y?[]:['change'];E(this,Z,function(){this.clear(Y),this.addItems(X,Y)})},setActiveItem:function(X,Y){var ee,te,ne,ie,se,oe,re,ae,Z=this;if('single'!==Z.settings.mode){if(X=t(X),!X.length)return t(Z.$activeItems).removeClass('active'),Z.$activeItems=[],void(Z.isFocused&&Z.showInput());if(ee=Y&&Y.type.toLowerCase(),'mousedown'===ee&&Z.isShiftDown&&Z.$activeItems.length){for(ae=Z.$control.children('.active:last'),ie=Array.prototype.indexOf.apply(Z.$control[0].childNodes,[ae[0]]),se=Array.prototype.indexOf.apply(Z.$control[0].childNodes,[X[0]]),ie>se&&(re=ie,ie=se,se=re),te=ie;te<=se;te++)oe=Z.$control[0].childNodes[te],-1===Z.$activeItems.indexOf(oe)&&(t(oe).addClass('active'),Z.$activeItems.push(oe));Y.preventDefault()}else'mousedown'===ee&&Z.isCtrlDown||'keydown'===ee&&this.isShiftDown?X.hasClass('active')?(ne=Z.$activeItems.indexOf(X[0]),Z.$activeItems.splice(ne,1),X.removeClass('active')):Z.$activeItems.push(X.addClass('active')[0]):(t(Z.$activeItems).removeClass('active'),Z.$activeItems=[X.addClass('active')[0]]);Z.hideInput(),this.isFocused||Z.focus()}},setActiveOption:function(X,Y,Z){var ee,te,ne,ie,se,oe=this;oe.$activeOption&&oe.$activeOption.removeClass('active'),oe.$activeOption=null,X=t(X),X.length&&(oe.$activeOption=X.addClass('active'),(Y||!T(Y))&&(ee=oe.$dropdown_content.height(),te=oe.$activeOption.outerHeight(!0),Y=oe.$dropdown_content.scrollTop()||0,ne=oe.$activeOption.offset().top-oe.$dropdown_content.offset().top+Y,ie=ne,se=ne-ee+te,ne+te>ee+Y?oe.$dropdown_content.stop().animate({scrollTop:se},Z?oe.settings.scrollDuration:0):ne<Y&&oe.$dropdown_content.stop().animate({scrollTop:ie},Z?oe.settings.scrollDuration:0)))},selectAll:function(){var X=this;'single'===X.settings.mode||(X.$activeItems=Array.prototype.slice.apply(X.$control.children(':not(input)').addClass('active')),X.$activeItems.length&&(X.hideInput(),X.close()),X.focus())},hideInput:function(){var X=this;X.setTextboxValue(''),X.$control_input.css({opacity:0,position:'absolute',left:X.rtl?1e4:-1e4}),X.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:'relative',left:0}),this.isInputHidden=!1},focus:function(){var X=this;X.isDisabled||(X.ignoreFocus=!0,X.$control_input[0].focus(),window.setTimeout(function(){X.ignoreFocus=!1,X.onFocus()},0))},blur:function(X){this.$control_input[0].blur(),this.onBlur(null,X)},getScoreFunction:function(X){return this.sifter.getScoreFunction(X,this.getSearchOptions())},getSearchOptions:function(){var X=this.settings,Y=X.sortField;return'string'==typeof Y&&(Y=[{field:Y}]),{fields:X.searchField,conjunction:X.searchConjunction,sort:Y}},search:function(X){var Y,te,ne,ie=this,se=ie.settings,oe=this.getSearchOptions();if(se.score&&(ne=ie.settings.score.apply(this,[X]),'function'!=typeof ne))throw new Error('Selectize "score" setting must be a function that returns a function');if(X===ie.lastQuery?te=t.extend(!0,{},ie.currentResults):(ie.lastQuery=X,te=ie.sifter.search(X,t.extend(oe,{score:ne})),ie.currentResults=te),se.hideSelected)for(Y=te.items.length-1;0<=Y;Y--)-1!==ie.items.indexOf(N(te.items[Y].id))&&te.items.splice(Y,1);return te},refreshOptions:function(X){var Y,Z,ee,te,ne,ie,se,oe,re,ae,le,de,pe,ue,ce,ge;'undefined'==typeof X&&(X=!0);var he=this,me=t.trim(he.$control_input.val()),fe=he.search(me),ve=he.$dropdown_content,ye=he.$activeOption&&N(he.$activeOption.attr('data-value'));for(te=fe.items.length,'number'==typeof he.settings.maxOptions&&(te=Math.min(te,he.settings.maxOptions)),ne={},ie=[],Y=0;Y<te;Y++)for(se=he.options[fe.items[Y].id],oe=he.render('option',se),re=se[he.settings.optgroupField]||'',ae=t.isArray(re)?re:[re],(Z=0,ee=ae&&ae.length);Z<ee;Z++)re=ae[Z],he.optgroups.hasOwnProperty(re)||(re=''),ne.hasOwnProperty(re)||(ne[re]=document.createDocumentFragment(),ie.push(re)),ne[re].appendChild(oe);for(this.settings.lockOptgroupOrder&&ie.sort(function(Oe,Ce){var we=he.optgroups[Oe].$order||0,$e=he.optgroups[Ce].$order||0;return we-$e}),le=document.createDocumentFragment(),(Y=0,te=ie.length);Y<te;Y++)re=ie[Y],he.optgroups.hasOwnProperty(re)&&ne[re].childNodes.length?(de=document.createDocumentFragment(),de.appendChild(he.render('optgroup_header',he.optgroups[re])),de.appendChild(ne[re]),le.appendChild(he.render('optgroup',t.extend({},he.optgroups[re],{html:M(de),dom:de})))):le.appendChild(ne[re]);if(ve.html(le),he.settings.highlight&&fe.query.length&&fe.tokens.length)for(ve.removeHighlight(),Y=0,te=fe.tokens.length;Y<te;Y++)r(ve,fe.tokens[Y].regex);if(!he.settings.hideSelected)for(Y=0,te=he.items.length;Y<te;Y++)he.getOption(he.items[Y]).addClass('selected');pe=he.canCreate(me),pe&&(ve.prepend(he.render('option_create',{input:me})),ge=t(ve[0].childNodes[0])),he.hasOptions=0<fe.items.length||pe,he.hasOptions?(0<fe.items.length?(ce=ye&&he.getOption(ye),ce&&ce.length?ue=ce:'single'===he.settings.mode&&he.items.length&&(ue=he.getOption(he.items[0])),(!ue||!ue.length)&&(ge&&!he.settings.addPrecedence?ue=he.getAdjacentOption(ge,1):ue=ve.find('[data-selectable]:first'))):ue=ge,he.setActiveOption(ue),X&&!he.isOpen&&he.open()):(he.setActiveOption(null),X&&he.isOpen&&he.close())},addOption:function(X){var Y,Z,ee,te=this;if(t.isArray(X)){for(Y=0,Z=X.length;Y<Z;Y++)te.addOption(X[Y]);return}(ee=te.registerOption(X))&&(te.userOptions[ee]=!0,te.lastQuery=null,te.trigger('option_add',ee,X))},registerOption:function(X){var Y=N(X[this.settings.valueField]);return'undefined'==typeof Y||null===Y||this.options.hasOwnProperty(Y)?!1:(X.$order=X.$order||++this.order,this.options[Y]=X,Y)},registerOptionGroup:function(X){var Y=N(X[this.settings.optgroupValueField]);return!!Y&&(X.$order=X.$order||++this.order,this.optgroups[Y]=X,Y)},addOptionGroup:function(X,Y){Y[this.settings.optgroupValueField]=X,(X=this.registerOptionGroup(Y))&&this.trigger('optgroup_add',X,Y)},removeOptionGroup:function(X){this.optgroups.hasOwnProperty(X)&&(delete this.optgroups[X],this.renderCache={},this.trigger('optgroup_remove',X))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger('optgroup_clear')},updateOption:function(X,Y){var ee,te,ne,ie,se,oe,re,Z=this;if((X=N(X),ne=N(Y[Z.settings.valueField]),null!==X)&&Z.options.hasOwnProperty(X)){if('string'!=typeof ne)throw new Error('Value must be set in option data');re=Z.options[X].$order,ne!==X&&(delete Z.options[X],ie=Z.items.indexOf(X),-1!==ie&&Z.items.splice(ie,1,ne)),Y.$order=Y.$order||re,Z.options[ne]=Y,se=Z.renderCache.item,oe=Z.renderCache.option,se&&(delete se[X],delete se[ne]),oe&&(delete oe[X],delete oe[ne]),-1!==Z.items.indexOf(ne)&&(ee=Z.getItem(X),te=t(Z.render('item',Y)),ee.hasClass('active')&&te.addClass('active'),ee.replaceWith(te)),Z.lastQuery=null,Z.isOpen&&Z.refreshOptions(!1)}},removeOption:function(X,Y){var Z=this;X=N(X);var ee=Z.renderCache.item,te=Z.renderCache.option;ee&&delete ee[X],te&&delete te[X],delete Z.userOptions[X],delete Z.options[X],Z.lastQuery=null,Z.trigger('option_remove',X),Z.removeItem(X,Y)},clearOptions:function(){var X=this;X.loadedSearches={},X.userOptions={},X.renderCache={},X.options=X.sifter.items={},X.lastQuery=null,X.trigger('option_clear'),X.clear()},getOption:function(X){return this.getElementWithValue(X,this.$dropdown_content.find('[data-selectable]'))},getAdjacentOption:function(X,Y){var Z=this.$dropdown.find('[data-selectable]'),ee=Z.index(X)+Y;return 0<=ee&&ee<Z.length?Z.eq(ee):t()},getElementWithValue:function(X,Y){if(X=N(X),'undefined'!=typeof X&&null!==X)for(var Z=0,ee=Y.length;Z<ee;Z++)if(Y[Z].getAttribute('data-value')===X)return t(Y[Z]);return t()},getItem:function(X){return this.getElementWithValue(X,this.$control.children())},addItems:function(X,Y){for(var Z=t.isArray(X)?X:[X],ee=0,te=Z.length;ee<te;ee++)this.isPending=ee<te-1,this.addItem(Z[ee],Y)},addItem:function(X,Y){var Z=Y?[]:['change'];E(this,Z,function(){var ee,te,ne,ae,le,ie=this,se=ie.settings.mode;return(X=N(X),-1!==ie.items.indexOf(X))?void('single'===se&&ie.close()):void(ie.options.hasOwnProperty(X)&&('single'===se&&ie.clear(Y),'multi'===se&&ie.isFull()||(ee=t(ie.render('item',ie.options[X])),le=ie.isFull(),ie.items.splice(ie.caretPos,0,X),ie.insertAtCaret(ee),(!ie.isPending||!le&&ie.isFull())&&ie.refreshState(),ie.isSetup&&(ne=ie.$dropdown_content.find('[data-selectable]'),!ie.isPending&&(te=ie.getOption(X),ae=ie.getAdjacentOption(te,1).attr('data-value'),ie.refreshOptions(ie.isFocused&&'single'!==se),ae&&ie.setActiveOption(ie.getOption(ae))),!ne.length||ie.isFull()?ie.close():ie.positionDropdown(),ie.updatePlaceholder(),ie.trigger('item_add',X,ee),ie.updateOriginalInput({silent:Y})))))})},removeItem:function(X,Y){var ee,te,ne,Z=this;ee=X instanceof t?X:Z.getItem(X),X=N(ee.attr('data-value')),te=Z.items.indexOf(X),-1!==te&&(ee.remove(),ee.hasClass('active')&&(ne=Z.$activeItems.indexOf(ee[0]),Z.$activeItems.splice(ne,1)),Z.items.splice(te,1),Z.lastQuery=null,!Z.settings.persist&&Z.userOptions.hasOwnProperty(X)&&Z.removeOption(X,Y),te<Z.caretPos&&Z.setCaret(Z.caretPos-1),Z.refreshState(),Z.updatePlaceholder(),Z.updateOriginalInput({silent:Y}),Z.positionDropdown(),Z.trigger('item_remove',X,ee))},createItem:function(X,Y){var Z=this,ee=Z.caretPos;X=X||t.trim(Z.$control_input.val()||'');var te=arguments[arguments.length-1];if('function'!=typeof te&&(te=function(){}),'boolean'!=typeof Y&&(Y=!0),!Z.canCreate(X))return te(),!1;Z.lock();var ne='function'==typeof Z.settings.create?this.settings.create:function(oe){var re={};return re[Z.settings.labelField]=oe,re[Z.settings.valueField]=oe,re},ie=L(function(oe){if(Z.unlock(),!oe||'object'!=typeof oe)return te();var re=N(oe[Z.settings.valueField]);return'string'==typeof re?void(Z.setTextboxValue(''),Z.addOption(oe),Z.setCaret(ee),Z.addItem(re),Z.refreshOptions(Y&&'single'!==Z.settings.mode),te(oe)):te()}),se=ne.apply(this,[X,ie]);return'undefined'!=typeof se&&ie(se),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var X=!this.items.length;this.isInvalid=X,this.$control_input.prop('required',X),this.$input.prop('required',!X)},refreshClasses:function(){var X=this,Y=X.isFull(),Z=X.isLocked;X.$wrapper.toggleClass('rtl',X.rtl),X.$control.toggleClass('focus',X.isFocused).toggleClass('disabled',X.isDisabled).toggleClass('required',X.isRequired).toggleClass('invalid',X.isInvalid).toggleClass('locked',Z).toggleClass('full',Y).toggleClass('not-full',!Y).toggleClass('input-active',X.isFocused&&!X.isInputHidden).toggleClass('dropdown-active',X.isOpen).toggleClass('has-options',!t.isEmptyObject(X.options)).toggleClass('has-items',0<X.items.length),X.$control_input.data('grow',!Y&&!Z)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(X){var Y,Z,ee,te,ne=this;if(X=X||{},ne.tagType===P){for(ee=[],Y=0,Z=ne.items.length;Y<Z;Y++)te=ne.options[ne.items[Y]][ne.settings.labelField]||'',ee.push('<option value="'+q(ne.items[Y])+'" selected="selected">'+q(te)+'</option>');ee.length||this.$input.attr('multiple')||ee.push('<option value="" selected="selected"></option>'),ne.$input.html(ee.join(''))}else ne.$input.val(ne.getValue()),ne.$input.attr('value',ne.$input.val());ne.isSetup&&!X.silent&&ne.trigger('change',ne.$input.val())},updatePlaceholder:function(){if(this.settings.placeholder){var X=this.$control_input;this.items.length?X.removeAttr('placeholder'):X.attr('placeholder',this.settings.placeholder),X.triggerHandler('update',{force:!0})}},open:function(){var X=this;X.isLocked||X.isOpen||'multi'===X.settings.mode&&X.isFull()||(X.focus(),X.isOpen=!0,X.refreshState(),X.$dropdown.css({visibility:'hidden',display:'block'}),X.positionDropdown(),X.$dropdown.css({visibility:'visible'}),X.trigger('dropdown_open',X.$dropdown))},close:function(){var X=this,Y=X.isOpen;'single'===X.settings.mode&&X.items.length&&(X.hideInput(),X.$control_input.blur()),X.isOpen=!1,X.$dropdown.hide(),X.setActiveOption(null),X.refreshState(),Y&&X.trigger('dropdown_close',X.$dropdown)},positionDropdown:function(){var X=this.$control,Y='body'===this.settings.dropdownParent?X.offset():X.position();Y.top+=X.outerHeight(!0),this.$dropdown.css({width:X.outerWidth(),top:Y.top,left:Y.left})},clear:function(X){var Y=this;Y.items.length&&(Y.$control.children(':not(input)').remove(),Y.items=[],Y.lastQuery=null,Y.setCaret(0),Y.setActiveItem(null),Y.updatePlaceholder(),Y.updateOriginalInput({silent:X}),Y.refreshState(),Y.showInput(),Y.trigger('clear'))},insertAtCaret:function(X){var Y=Math.min(this.caretPos,this.items.length);0===Y?this.$control.prepend(X):t(this.$control[0].childNodes[Y]).before(X),this.setCaret(Y+1)},deleteSelection:function(X){var Y,Z,ee,te,ne,ie,se,oe,re,ae=this;if(ee=X&&X.keyCode===_?-1:1,te=W(ae.$control_input[0]),ae.$activeOption&&!ae.settings.hideSelected&&(se=ae.getAdjacentOption(ae.$activeOption,-1).attr('data-value')),ne=[],ae.$activeItems.length){for(re=ae.$control.children('.active:'+(0<ee?'last':'first')),ie=ae.$control.children(':not(input)').index(re),0<ee&&ie++,(Y=0,Z=ae.$activeItems.length);Y<Z;Y++)ne.push(t(ae.$activeItems[Y]).attr('data-value'));X&&(X.preventDefault(),X.stopPropagation())}else(ae.isFocused||'single'===ae.settings.mode)&&ae.items.length&&(0>ee&&0===te.start&&0===te.length?ne.push(ae.items[ae.caretPos-1]):0<ee&&te.start===ae.$control_input.val().length&&ne.push(ae.items[ae.caretPos]));if(!ne.length||'function'==typeof ae.settings.onDelete&&!1===ae.settings.onDelete.apply(ae,[ne]))return!1;for('undefined'!=typeof ie&&ae.setCaret(ie);ne.length;)ae.removeItem(ne.pop());return ae.showInput(),ae.positionDropdown(),ae.refreshOptions(!0),se&&(oe=ae.getOption(se),oe.length&&ae.setActiveOption(oe)),!0},advanceSelection:function(X,Y){var Z,ee,te,ne,ie,se,oe=this;0===X||(oe.rtl&&(X*=-1),Z=0<X?'last':'first',ee=W(oe.$control_input[0]),oe.isFocused&&!oe.isInputHidden?(ne=oe.$control_input.val().length,ie=0>X?0===ee.start&&0===ee.length:ee.start===ne,ie&&!ne&&oe.advanceCaret(X,Y)):(se=oe.$control.children('.active:'+Z),se.length&&(te=oe.$control.children(':not(input)').index(se),oe.setActiveItem(null),oe.setCaret(0<X?te+1:te))))},advanceCaret:function(X,Y){var ee,te,Z=this;0===X||(ee=0<X?'next':'prev',Z.isShiftDown?(te=Z.$control_input[ee](),te.length&&(Z.hideInput(),Z.setActiveItem(te),Y&&Y.preventDefault())):Z.setCaret(Z.caretPos+X))},setCaret:function(X){var Y=this;if(X='single'===Y.settings.mode?Y.items.length:Math.max(0,Math.min(Y.items.length,X)),!Y.isPending){var Z,ee,ne,ie;for(ne=Y.$control.children(':not(input)'),Z=0,ee=ne.length;Z<ee;Z++)ie=t(ne[Z]).detach(),Z<X?Y.$control_input.before(ie):Y.$control.append(ie)}Y.caretPos=X},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var X=this;X.$input.prop('disabled',!0),X.$control_input.prop('disabled',!0).prop('tabindex',-1),X.isDisabled=!0,X.lock()},enable:function(){var X=this;X.$input.prop('disabled',!1),X.$control_input.prop('disabled',!1).prop('tabindex',X.tabIndex),X.isDisabled=!1,X.unlock()},destroy:function(){var X=this,Y=X.eventNS,Z=X.revertSettings;X.trigger('destroy'),X.off(),X.$wrapper.remove(),X.$dropdown.remove(),X.$input.html('').append(Z.$children).removeAttr('tabindex').removeClass('selectized').attr({tabindex:Z.tabindex}).show(),X.$control_input.removeData('grow'),X.$input.removeData('selectize'),t(window).off(Y),t(document).off(Y),t(document.body).off(Y),delete X.$input[0].selectize},render:function(X,Y){var Z,ee,ne='',ie=!1,se=this,oe=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;return(('option'===X||'item'===X)&&(Z=N(Y[se.settings.valueField]),ie=!!Z),ie&&(T(se.renderCache[X])||(se.renderCache[X]={}),se.renderCache[X].hasOwnProperty(Z)))?se.renderCache[X][Z]:(ne=t(se.settings.render[X].apply(this,[Y,q])),'option'===X||'option_create'===X?ne.attr('data-selectable',''):'optgroup'==X&&(ee=Y[se.settings.optgroupValueField]||'',ne.attr('data-group',ee)),('option'===X||'item'===X)&&ne.attr('data-value',Z||''),ie&&(se.renderCache[X][Z]=ne[0]),ne[0])},clearCache:function(X){var Y=this;'undefined'==typeof X?Y.renderCache={}:delete Y.renderCache[X]},canCreate:function(X){var Y=this;if(!Y.settings.create)return!1;var Z=Y.settings.createFilter;return X.length&&('function'!=typeof Z||Z.apply(Y,[X]))&&('string'!=typeof Z||new RegExp(Z).test(X))&&(!(Z instanceof RegExp)||Z.test(X))}}),J.count=0,J.defaults={options:[],optgroups:[],plugins:[],delimiter:',',splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:'loading',dataAttr:'data-data',optgroupField:'optgroup',valueField:'value',labelField:'text',optgroupLabelField:'label',optgroupValueField:'value',lockOptgroupOrder:!1,sortField:'$order',searchField:['text'],searchConjunction:'and',mode:null,wrapperClass:'selectize-control',inputClass:'selectize-input',dropdownClass:'selectize-dropdown',dropdownContentClass:'selectize-dropdown-content',dropdownParent:null,copyClassesToDropdown:!0,render:{}},t.fn.selectize=function(X){var Y=t.fn.selectize.defaults,Z=t.extend({},Y,X),ee=Z.dataAttr,te=Z.labelField,ne=Z.valueField,ie=Z.optgroupField,se=Z.optgroupLabelField,oe=Z.optgroupValueField,re=function(le,de){var pe,ue,ce,ge,he=le.attr(ee);if(!he){var me=t.trim(le.val()||'');if(!Z.allowEmptyOption&&!me.length)return;for(ce=me.split(Z.delimiter),pe=0,ue=ce.length;pe<ue;pe++)ge={},ge[te]=ce[pe],ge[ne]=ce[pe],de.options.push(ge);de.items=ce}else for(de.options=JSON.parse(he),pe=0,ue=de.options.length;pe<ue;pe++)de.items.push(de.options[pe][ne])},ae=function(le,de){var pe,ue,ce,ge,me=de.options,fe={},ve=function(Ce){var we=ee&&Ce.attr(ee);return'string'==typeof we&&we.length?JSON.parse(we):null},ye=function(Ce,we){Ce=t(Ce);var $e=N(Ce.val());if($e||Z.allowEmptyOption){if(fe.hasOwnProperty($e)){if(we){var be=fe[$e][ie];be?t.isArray(be)?be.push(we):fe[$e][ie]=[be,we]:fe[$e][ie]=we}return}var _e=ve(Ce)||{};_e[te]=_e[te]||Ce.text(),_e[ne]=_e[ne]||$e,_e[ie]=_e[ie]||we,fe[$e]=_e,me.push(_e),Ce.is(':selected')&&de.items.push($e)}},Oe=function(Ce){var we,$e,be,_e,xe;for(Ce=t(Ce),be=Ce.attr('label'),be&&(_e=ve(Ce)||{},_e[se]=be,_e[oe]=be,de.optgroups.push(_e)),xe=t('option',Ce),(we=0,$e=xe.length);we<$e;we++)ye(xe[we],be)};for(de.maxItems=le.attr('multiple')?null:1,ge=le.children(),(pe=0,ue=ge.length);pe<ue;pe++)ce=ge[pe].tagName.toLowerCase(),'optgroup'===ce?Oe(ge[pe]):'option'==ce&&ye(ge[pe])};return this.each(function(){if(!this.selectize){var le,de=t(this),pe=this.tagName.toLowerCase(),ue=de.attr('placeholder')||de.attr('data-placeholder');ue||Z.allowEmptyOption||(ue=de.children('option[value=""]').text());var ce={placeholder:ue,options:[],optgroups:[],items:[]};'select'===pe?ae(de,ce):re(de,ce),le=new J(de,t.extend(!0,{},Y,ce,X))}})},t.fn.selectize.defaults=J.defaults,t.fn.selectize.support={validity:z},J.define('drag_drop',function(){if(!t.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if('multi'===this.settings.mode){var Y=this;Y.lock=function(){var Z=Y.lock;return function(){var ee=Y.$control.data('sortable');return ee&&ee.disable(),Z.apply(Y,arguments)}}(),Y.unlock=function(){var Z=Y.unlock;return function(){var ee=Y.$control.data('sortable');return ee&&ee.enable(),Z.apply(Y,arguments)}}(),Y.setup=function(){var Z=Y.setup;return function(){Z.apply(this,arguments);var ee=Y.$control.sortable({items:'[data-value]',forcePlaceholderSize:!0,disabled:Y.isLocked,start:function(te,ne){ne.placeholder.css('width',ne.helper.css('width')),ee.css({overflow:'visible'})},stop:function(){ee.css({overflow:'hidden'});var te=Y.$activeItems?Y.$activeItems.slice():null,ne=[];ee.children('[data-value]').each(function(){ne.push(t(this).attr('data-value'))}),Y.setValue(ne),Y.setActiveItem(te)}})}}()}}),J.define('dropdown_header',function(X){var Y=this;X=t.extend({title:'Untitled',headerClass:'selectize-dropdown-header',titleRowClass:'selectize-dropdown-header-title',labelClass:'selectize-dropdown-header-label',closeClass:'selectize-dropdown-header-close',html:function(Z){return'<div class="'+Z.headerClass+'"><div class="'+Z.titleRowClass+'"><span class="'+Z.labelClass+'">'+Z.title+'</span><a href="javascript:void(0)" class="'+Z.closeClass+'">&times;</a></div></div>'}},X),Y.setup=function(){var Z=Y.setup;return function(){Z.apply(Y,arguments),Y.$dropdown_header=t(X.html(X)),Y.$dropdown.prepend(Y.$dropdown_header)}}()}),J.define('optgroup_columns',function(X){var Y=this;X=t.extend({equalizeWidth:!0,equalizeHeight:!0},X),this.getAdjacentOption=function(te,ne){var ie=te.closest('[data-group]').find('[data-selectable]'),se=ie.index(te)+ne;return 0<=se&&se<ie.length?ie.eq(se):t()},this.onKeyDown=function(){var te=Y.onKeyDown;return function(ne){var ie,se,oe,re;return this.isOpen&&(ne.keyCode===m||ne.keyCode===O)?(Y.ignoreHover=!0,re=this.$activeOption.closest('[data-group]'),ie=re.find('[data-selectable]').index(this.$activeOption),re=ne.keyCode===m?re.prev('[data-group]'):re.next('[data-group]'),oe=re.find('[data-selectable]'),se=oe.eq(Math.min(oe.length-1,ie)),void(se.length&&this.setActiveOption(se))):te.apply(this,arguments)}}();var Z=function(){var te,ne=Z.width,ie=document;return'undefined'==typeof ne&&(te=ie.createElement('div'),te.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',te=te.firstChild,ie.body.appendChild(te),ne=Z.width=te.offsetWidth-te.clientWidth,ie.body.removeChild(te)),ne},ee=function(){var te,ne,ie,se,oe,re,ae;if(ae=t('[data-group]',Y.$dropdown_content),ne=ae.length,ne&&Y.$dropdown_content.width()){if(X.equalizeHeight){for(ie=0,te=0;te<ne;te++)ie=Math.max(ie,ae.eq(te).height());ae.css({height:ie})}X.equalizeWidth&&(re=Y.$dropdown_content.innerWidth()-Z(),se=Math.round(re/ne),ae.css({width:se}),1<ne&&(oe=re-se*(ne-1),ae.eq(ne-1).css({width:oe})))}};(X.equalizeHeight||X.equalizeWidth)&&(H.after(this,'positionDropdown',ee),H.after(this,'refreshOptions',ee))}),J.define('remove_button',function(X){X=t.extend({label:'&times;',title:'Remove',className:'remove',append:!0},X);return'single'===this.settings.mode?void function(ee,te){te.className='remove-single';var ne=ee,ie='<a href="javascript:void(0)" class="'+te.className+'" tabindex="-1" title="'+q(te.title)+'">'+te.label+'</a>',se=function(oe,re){return oe+re};ee.setup=function(){var oe=ne.setup;return function(){if(te.append){var re=t(ne.$input.context).attr('id'),ae=t('#'+re),le=ne.settings.render.item;ne.settings.render.item=function(){return se(le.apply(ee,arguments),ie)}}oe.apply(ee,arguments),ee.$control.on('click','.'+te.className,function(de){de.preventDefault(),ne.isLocked||ne.clear()})}}()}(this,X):void function(ee,te){var ne=ee,ie='<a href="javascript:void(0)" class="'+te.className+'" tabindex="-1" title="'+q(te.title)+'">'+te.label+'</a>',se=function(oe,re){var ae=oe.search(/(<\/[^>]+>\s*)$/);return oe.substring(0,ae)+re+oe.substring(ae)};ee.setup=function(){var oe=ne.setup;return function(){if(te.append){var re=ne.settings.render.item;ne.settings.render.item=function(){return se(re.apply(ee,arguments),ie)}}oe.apply(ee,arguments),ee.$control.on('click','.'+te.className,function(ae){if(ae.preventDefault(),!ne.isLocked){var le=t(ae.currentTarget).parent();ne.setActiveItem(le),ne.deleteSelection()&&ne.setCaret(ne.items.length)}})}}()}(this,X)}),J.define('restore_on_backspace',function(X){var Y=this;X.text=X.text||function(Z){return Z[this.settings.labelField]},this.onKeyDown=function(){var Z=Y.onKeyDown;return function(ee){var te,ne;return ee.keyCode===_&&''===this.$control_input.val()&&!this.$activeItems.length&&(te=this.caretPos-1,0<=te&&te<this.items.length)?(ne=this.options[this.items[te]],this.deleteSelection(ee)&&(this.setTextboxValue(X.text.apply(this,[ne])),this.refreshOptions(!0)),void ee.preventDefault()):Z.apply(this,arguments)}}()}),J});